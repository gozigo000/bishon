# 목차
    1. 수정 내용
    2. hlz 파일의 ZIP 구조

# 수정 내용

## 라이브러리 사용 부분

    1. 파일 이름 인코딩 방식 설정
    2. 압축 방식 설정
    3. 압축 레벨 설정

    ```TS
    const zipBuffer = await jszip.generateAsync({ 
        // 노드 버퍼 타입으로 설정
        type: 'nodebuffer', 
        // 파일 이름 인코딩 방식 cp949로 설정
        encodeFileName: (filename) => iconv.encode(filename, 'cp949').toString('binary'), 
        // 압축 방식 DEFLATE로 설정
        compression: 'DEFLATE', 
        // 압축 레벨 1로 설정
        compressionOptions: {
            level: 1 
        }
    });
    ```

## 소스코드: ./node_modules/jszip/lib/generate/ZipFileWorker.js

    1. `extra field` 생성 방지

    ```TS
    // `extra field` 생성 방지하기 위해 `&& false` 추가
    if (useUTF8ForFileName && false) {
        // ...
    }
    ```

    2. `version needed to extract` 일치시키기

    ```TS
    // version needed to extract
    header += "\x14\x00"; // += "\x0A\x00" // 원래 값
    ```


# ZIP 파일의 구조

    [local file header 1]
    [file data 1]
    ...
    [local file header N]
    [file data N]
    
    [central directory 1]
    ...
    [central directory N]

    [end of central directory record]

## Local file header: [504B0304]
                                             hlz    | 1st Try | 2nd Try
    local file header signature     4 bytes  (504b0304)
    version needed to extract       2 bytes  14 00  |  14 0A  |  0A 00
    general purpose bit flag        2 bytes  00 00  |  00 08  |  00 00
    compression method              2 bytes  08 00  |    -    |    -
    last mod file time              2 bytes  ## ## 
    last mod file date              2 bytes  ## ## 
    crc-32                          4 bytes  8B8807FE (일치)
    compressed size                 4 bytes  ######## (to be 일치)
    uncompressed size               4 bytes  ######## (일치)
    file name length                2 bytes  12 00 (to be 일치)
    extra field length              2 bytes  00 00  |    -    |  ## ##

    file name               (variable size)  (to be 일치)
    extra field             (variable size)  None   |    -    |  ## ##

## file data

## Central directory file header: [504B0102]
                                             hlz   | 1st Try | 2nd Try
    central file header signature   4 bytes  (504b0102)
    version made by                 2 bytes  14 00 | 14 0A | 0A 00
    version needed to extract       2 bytes
    general purpose bit flag        2 bytes
    compression method              2 bytes
    last mod file time              2 bytes
    last mod file date              2 bytes
    crc-32                          4 bytes
    compressed size                 4 bytes
    uncompressed size               4 bytes
    file name length                2 bytes
    extra field length              2 bytes
    file comment length             2 bytes  00 00  |    -    |    -
    disk number start               2 bytes  00 00  |    -    |    -
    internal file attributes        2 bytes  00 00  |    -    |    -
    external file attributes        4 bytes  00000000 | 0000B681 |
    relative offset of local header 4 bytes  00000000 (일치)

    file name               (variable size)
    extra field             (variable size)
    file comment            (variable size)

## End of central directory record: [504B0506]
                                             hlz   | 1st Try | 2nd Try
    end of central dir signature    4 bytes  (504b0506)
    number of this disk             2 bytes  00 00 |    -    |    -
    number of the disk with the
    start of the central directory  2 bytes  00 00 |    -    |    -
    total number of entries in the
    central directory on this disk  2 bytes  29 00 |    -    |    -
    total number of entries in
    the central directory           2 bytes  29 00 |    -    |    -
    size of the central directory   4 bytes  50 09 00 00 | 53 09 00 00 |
    offset of start of central
    directory with respect to
    the starting disk number        4 bytes  FC FC 05 00 | BE E7 05 00 |
    .ZIP file comment length        2 bytes  00 00 |    -    |    -
    .ZIP file comment       (variable size)   None |    -    |    -


